# 구현 계획

- [x] 1. 함수 호출로 백엔드 AssistanceService 강화
  - getTodos 도구로 Gemini 함수 호출을 지원하도록 AssistanceService 수정
  - TodoService 주입 추가 및 AI 쿼리를 위한 getTodos 메서드 구현
  - 함수 호출을 위한 시스템 프롬프트 처리 및 오류 관리 업데이트
  - _요구사항: 3.1, 3.2, 3.3, 3.4, 4.4_

- [x] 1.1 함수 호출을 위한 AssistanceService 업데이트
  - AssistanceService 생성자에 TodoService 의존성 주입 추가
  - 적절한 매개변수(status, days)로 getTodos 도구 정의 구현
  - 함수 호출 워크플로를 처리하도록 getGeminiResponse 메서드 수정
  - _요구사항: 3.1, 3.2, 3.3_

- [x] 1.2 AI 쿼리를 위한 TodoService getTodos 메서드 추가
  - status 및 days 매개변수를 허용하는 getTodos 메서드를 TodoService에 생성
  - 다양한 상태 필터(완료, 미완료, 지연)에 대한 유연한 todo 쿼리 로직 구현
  - AI 컨텍스트 처리에 적합한 구조화된 todo 데이터 반환
  - _요구사항: 3.2, 3.4_

- [ ]* 1.3 향상된 AssistanceService에 대한 단위 테스트 작성
  - 모의 TodoService로 함수 호출 워크플로 테스트
  - 실패한 함수 호출에 대한 오류 처리 테스트
  - 시스템 프롬프트 로딩 및 폴백 동작 테스트
  - _요구사항: 3.1, 3.2, 3.3, 3.4_

- [x] 2. 채팅 API 엔드포인트 및 DTO 생성
  - POST /api/assistance/chat 엔드포인트로 ChatController 생성
  - API 통신을 위한 ChatRequestDto 및 ChatResponseDto 구현
  - 세션 인증 가드 및 사용자 컨텍스트 처리 추가
  - _요구사항: 2.1, 2.2, 4.4_

- [x] 2.1 채팅 DTO 및 인터페이스 생성
  - 프롬프트 유효성 검사로 ChatRequestDto 정의
  - 응답, 타임스탬프 및 오류 필드로 ChatResponseDto 정의
  - 구조화된 AI 응답을 위한 TodoSummaryDto 생성
  - _요구사항: 2.1, 2.2_

- [x] 2.2 ChatController 구현
  - 적절한 의존성 주입으로 ChatController 생성
  - 인증으로 POST /api/assistance/chat 엔드포인트 구현
  - 요청 유효성 검사 및 오류 처리 미들웨어 추가
  - _요구사항: 2.1, 2.2, 4.4_

- [ ]* 2.3 채팅 API에 대한 통합 테스트 작성
  - 유효한 프롬프트로 인증된 채팅 요청 테스트
  - 잘못된 요청 및 인증 실패에 대한 오류 응답 테스트
  - API 엔드포인트를 통한 함수 호출 통합 테스트
  - _요구사항: 2.1, 2.2, 4.4_

- [x] 3. 프론트엔드 채팅 컴포넌트 생성
  - 적절한 위치 지정 및 아이콘으로 FloatingActionButton 컴포넌트 구축
  - 메시지 표시 및 입력 처리로 ChatModal 컴포넌트 생성
  - 사용자 및 AI 메시지 렌더링을 위한 ChatMessage 컴포넌트 구현
  - _요구사항: 1.1, 1.2, 1.3, 1.4, 2.3, 2.4, 5.1, 5.2_

- [x] 3.1 FloatingActionButton 컴포넌트 생성
  - 채팅/닫기 아이콘 상태로 고정 위치 버튼 컴포넌트 구축
  - 적절한 z-index 및 반응형 위치 지정 구현
  - 클릭 핸들러 및 접근성 속성 추가
  - _요구사항: 1.1, 1.2, 1.3, 1.4_

- [x] 3.2 ChatModal 컴포넌트 구축
  - 적절한 배경 및 위치 지정으로 모달 오버레이 생성
  - 자동 스크롤로 메시지 스레드 표시 구현
  - 전송 버튼 및 Enter 키 처리로 입력 필드 추가
  - _요구사항: 2.3, 2.4, 5.1, 5.2, 5.3, 5.4_

- [x] 3.3 ChatMessage 컴포넌트 구현
  - 사용자/AI 스타일 차별화로 메시지 컴포넌트 생성
  - 새니타이제이션으로 AI 응답에 대한 HTML 렌더링 지원 추가
  - 타임스탬프 표시 및 메시지 래핑 구현
  - _요구사항: 2.5, 5.1, 5.2, 5.5_

- [ ]* 3.4 컴포넌트 단위 테스트 작성
  - FloatingActionButton 클릭 처리 및 아이콘 상태 테스트
  - ChatModal 메시지 표시 및 입력 기능 테스트
  - 사용자 및 AI 메시지 모두에 대한 ChatMessage 렌더링 테스트
  - Zustand 스토어 액션 및 지속성 동작 테스트
  - _요구사항: 1.1, 1.2, 2.3, 2.4, 5.1, 5.2, 5.4_

- [x] 4. TodoContainer에 채팅 인터페이스 통합
  - TodoContainer 컴포넌트에 채팅 상태 관리 추가
  - 기존 레이아웃에 FloatingActionButton 및 ChatModal 통합
  - 오류 처리 및 로딩 상태로 API 통신 구현
  - _요구사항: 1.1, 1.4, 2.1, 2.2, 2.4, 5.4_

- [x] 4.1 지속성으로 Zustand 채팅 스토어 생성
  - persist 미들웨어로 Zustand를 사용하여 chatStore.js 생성
  - 메시지 기록 지속성을 위한 sessionStorage 구성
  - 메시지 추가, 로딩 상태 및 오류 처리를 위한 액션 구현
  - _요구사항: 5.1, 5.4_

- [x] 4.2 TodoContainer에 채팅 상태 추가
  - isChatOpen 상태 및 채팅 관련 상태 관리 추가
  - TodoContainer 컴포넌트에 Zustand 채팅 스토어 통합
  - 채팅 토글 핸들러 및 모달 제어 로직 구현
  - _요구사항: 1.1, 1.4, 5.4_

- [x] 4.3 채팅 API 통합 구현
  - 적절한 오류 처리로 채팅 요청을 위한 API 서비스 함수 생성
  - API 호출 중 상태 관리를 위해 Zustand 스토어와 통합
  - 스토어 액션을 사용하여 메시지 전송 및 응답 처리 로직 구현
  - _요구사항: 2.1, 2.2, 2.4_

- [x] 4.4 접근성 및 키보드 지원 추가
  - 모달 열기/닫기를 위한 적절한 포커스 관리 구현
  - 키보드 탐색 지원 추가(Tab, Enter, Escape)
  - ARIA 레이블 및 스크린 리더 지원 포함
  - _요구사항: 6.2, 6.3, 6.4, 6.5_

- [ ]* 4.5 채팅 기능에 대한 통합 테스트 작성
  - 버튼 클릭부터 응답 표시까지 완전한 채팅 흐름 테스트
  - Zustand 스토어 지속성 및 상태 관리 테스트
  - 오류 처리, 로딩 상태 및 접근성 기능 테스트
  - _요구사항: 1.1, 2.1, 2.2, 5.4, 6.2, 6.3, 6.4_

- [x] 5. 반응형 디자인 및 스타일링 추가
  - 모바일 반응성으로 채팅 컴포넌트에 대한 CSS 스타일 생성
  - 적절한 z-index 레이어링 및 모달 배경 구현
  - 로딩 표시기 및 오류 메시지 스타일링 추가
  - _요구사항: 1.1, 1.3, 2.4, 6.1_

- [x] 5.1 FloatingActionButton 및 ChatModal 스타일링
  - 플로팅 버튼 위치 지정을 위한 반응형 CSS 생성
  - 적절한 크기 및 반응형 동작으로 채팅 모달 스타일링
  - 부드러운 전환 및 호버 효과 추가
  - _요구사항: 1.1, 1.3, 6.1_

- [x] 5.2 채팅 메시지 및 입력 스타일링
  - 사용자 대 AI 메시지에 대한 고유한 스타일링 생성
  - 전송 버튼 및 로딩 상태로 입력 필드 스타일링
  - 메시지 가독성을 위한 적절한 간격 및 타이포그래피 추가
  - _요구사항: 2.4, 5.1, 5.2, 5.5_

- [x] 5.3 장치 전반에 걸쳐 반응형 디자인 테스트
  - 모바일 및 데스크톱 화면 크기에서 채팅 인터페이스 테스트
  - 모바일에서 터치 상호 작용 및 버튼 크기 확인
  - 다양한 장치에서 모달 동작 및 스크롤 테스트
  - _요구사항: 6.1_

- [x] 6. 오류 처리 및 사용자 피드백 구현
  - API 실패 및 네트워크 문제에 대한 포괄적인 오류 처리 추가
  - 사용자 친화적인 한국어 오류 메시지 구현
  - 로딩 표시기 및 요청 제한 추가
  - _요구사항: 2.4, 4.4, 4.5_

- [x] 6.1 프론트엔드 오류 처리 추가
  - 오류 상태 관리 및 표시 구현
  - 다양한 실패 시나리오에 대한 한국어 오류 메시지 추가
  - 오류 복구 메커니즘 및 재시도 기능 생성
  - _요구사항: 2.4, 4.5_

- [x] 6.2 로딩 상태 및 피드백 추가
  - API 요청 중 로딩 표시기 구현
  - 타이핑 표시기 및 메시지 전송 피드백 추가
  - 적절한 상태 관리로 여러 동시 요청 방지
  - _요구사항: 2.4_

- [ ]* 6.3 오류 시나리오 및 엣지 케이스 테스트
  - 네트워크 실패 처리 및 오류 메시지 표시 테스트
  - API 타임아웃 시나리오 및 복구 메커니즘 테스트
  - 빈 응답 및 잘못된 형식의 데이터와 같은 엣지 케이스 테스트
  - _요구사항: 2.4, 4.4, 4.5_
