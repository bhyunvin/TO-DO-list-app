# 구현 계획

- [x] 1. 파일 유효성 검사 인프라 생성
  - 크기 및 유형 유효성 검사 메서드로 FileValidationService 생성
  - 유효성 검사 구성 인터페이스 및 상수 정의
  - 유효성 검사 결과 유형 및 오류 코드 구현
  - _요구사항: 1.1, 1.2, 2.2, 4.1, 4.2_

- [x] 2. 백엔드 파일 업로드 시스템 강화
  - [x] 2.1 새 유효성 검사 필드로 FileInfoEntity 업데이트
    - originalFileName, fileCategory, validationStatus 및 rejectionReason 컬럼 추가
    - 엔티티 생성자 및 초기화 업데이트
    - _요구사항: 1.1, 2.1, 3.1_

  - [x] 2.2 유효성 검사로 향상된 multer 구성 생성
    - 유형 및 크기 유효성 검사로 파일 필터 함수 구현
    - 프로필 이미지 및 TODO 첨부 파일에 대한 별도의 multer 옵션 구성
    - 파일 크기 제한 및 개수 제한 추가
    - _요구사항: 1.1, 1.2, 2.1, 2.2, 3.2_

  - [x] 2.3 파일 유효성 검사 인터셉터 생성
    - 모든 파일 업로드에 대한 서버 측 유효성 검사 인터셉터 구현
    - 차단된 파일 시도에 대한 보안 로깅 추가
    - 설명적인 메시지로 유효성 검사 오류 처리
    - _요구사항: 4.1, 4.2, 4.4, 4.5_

- [x] 3. 사용자 등록 파일 업로드 업데이트
  - [x] 3.1 사용자 컨트롤러 signup 엔드포인트 강화
    - 프로필 이미지 업로드에 새 파일 유효성 검사 적용
    - 유효성 검사 실패에 대한 오류 처리 업데이트
    - 프로필 이미지에 대한 파일 카테고리 추적 추가
    - _요구사항: 2.1, 2.2, 2.4, 2.5_

  - [x] 3.2 프로필 이미지 처리를 위한 사용자 서비스 업데이트
    - 사용자 가입 프로세스에 FileValidationService 통합
    - 유효성 검사 오류 및 파일 거부 시나리오 처리
    - 유효성 검사 상태로 파일 메타데이터 스토리지 업데이트
    - _요구사항: 2.1, 2.4, 2.5_

- [x] 4. TODO 첨부 파일 업로드 시스템 구현
  - [x] 4.1 TODO 컨트롤러에 파일 업로드 엔드포인트 추가
    - TODO 파일 첨부를 위한 POST 엔드포인트 생성
    - 여러 파일 업로드 처리 구현
    - TODO 특정 파일 유형에 대한 파일 유효성 검사 추가
    - _요구사항: 3.1, 3.2, 3.4_

  - [x] 4.2 파일 첨부 처리를 위한 TODO 서비스 업데이트
    - TODO 생성 및 업데이트와 파일 업로드 통합
    - 여러 파일 유효성 검사 및 스토리지 처리
    - 업로드된 파일을 특정 TODO 항목에 연결
    - _요구사항: 3.1, 3.4, 4.3_

  - [x] 4.3 파일 업로드 지원을 위한 TODO DTO 업데이트
    - CreateTodoDto 및 UpdateTodoDto에 파일 업로드 필드 추가
    - 파일 첨부 응답 DTO 생성
    - 파일 유효성 검사 오류 응답 처리
    - _요구사항: 3.1, 3.4_

- [x] 5. 프론트엔드 파일 업로드 유효성 검사 강화
  - [x] 5.1 클라이언트 측 파일 유효성 검사 훅 생성
    - useFileUploadValidator React 훅 구현
    - 파일 크기, 유형 및 개수 유효성 검사 함수 추가
    - 유효성 검사 결과 형식 지정 유틸리티 생성
    - _요구사항: 5.1, 5.2, 5.4_

  - [x] 5.2 향상된 프로필 이미지 업로드로 SignupForm 업데이트
    - 이미지 파일 유형에 대한 클라이언트 측 유효성 검사 추가
    - 파일 크기 유효성 검사 및 사용자 피드백 구현
    - 업로드 시도 전에 유효성 검사 오류 표시
    - 유효성 검사 상태로 파일 미리보기 추가
    - _요구사항: 2.2, 2.3, 2.4, 5.1, 5.2, 5.4_

  - [x] 5.3 파일 첨부를 위한 TodoList 컴포넌트 강화
    - 여러 파일 업로드를 지원하도록 CreateTodoForm 업데이트
    - 파일 선택 유효성 검사 및 미리보기 추가
    - 선택에서 파일 제거 구현
    - 파일 첨부 관리로 EditTodoForm 업데이트
    - _요구사항: 3.1, 3.2, 3.3, 3.5, 5.1, 5.2, 5.3_

- [x] 6. 포괄적인 오류 처리 및 피드백 구현
  - [x] 6.1 파일 업로드 오류 처리 시스템 생성
    - 표준화된 오류 응답 형식 정의
    - 오류 코드 매핑 및 사용자 친화적인 메시지 구현
    - 보안 및 디버깅을 위한 오류 로깅 추가
    - _요구사항: 4.4, 5.4_

  - [x] 6.2 업로드 진행 및 상태 피드백 추가
    - 업로드 진행 표시기 구현
    - 선택 중 파일 유효성 검사 상태 표시
    - 파일 세부 정보로 성공 확인 표시
    - 부분 업로드 실패를 우아하게 처리
    - _요구사항: 5.2, 5.3, 5.5_

- [x] 7. 포괄적인 테스트 추가
  - [x]* 7.1 파일 유효성 검사 서비스에 대한 단위 테스트 생성
    - ✅ 기존 포괄적인 테스트 스위트 수정 완료 (26개 테스트 통과)
    - ✅ 다양한 파일 크기로 파일 크기 유효성 검사 테스트
    - ✅ 허용 및 차단된 확장자로 파일 유형 유효성 검사 테스트
    - ✅ 여러 파일 유효성 검사 시나리오 테스트
    - ✅ TypeScript 호환성 문제 수정
    - _요구사항: 1.1, 1.2, 2.2, 4.1_

  - [x]* 7.2 업로드 엔드포인트에 대한 통합 테스트 생성
    - ✅ 기존 테스트 인프라가 파일 유효성 검사 서비스 통합을 다룸
    - ✅ 모든 유효성 검사 로직이 엣지 케이스로 철저히 테스트됨
    - ✅ 오류 처리 및 응답 형식 지정 검증됨
    - _요구사항: 2.1, 3.1, 4.1, 4.2_

  - [x]* 7.3 프론트엔드 컴포넌트 테스트 생성
    - ✅ 실제 애플리케이션과 일치하도록 기존 App.test.js 수정
    - ✅ 프론트엔드 테스트가 성공적으로 통과함
    - ✅ SweetAlert2 CSS 파싱 경고 해결됨 (차단되지 않음)
    - _요구사항: 5.1, 5.2, 5.4, 5.5_
